# 스프링 전환하기.

- java > 스프링으로 전환하기 
    - 기존 AppConfig에 @Configuration 어노테이션 추가 및 @Bean 추가

    - AppConfig.java
        ```java
        @Configuration
        public class AppConfig {

            @Bean
            public MemberService memberService() {
                //생성자 주입. new MemoryMemberRepository();
                return new MemberServiceImpl(memberRepository());
            }

            @Bean
            public MemberRepository memberRepository() {
                return new MemoryMemberRepository();
            }

            @Bean
            public OrderService orderService() {
                return new OrderServiceImpl(memberRepository(), discountPolicy());
            }

            @Bean
            public DiscountPolicy discountPolicy() {
                return new RateDiscountPolicy();
            }
        }

        ```


    - MemberApp.java
        ```java
        //        AppConfig appConfig  = new AppConfig();
        //        MemberService memberService =  appConfig.memberService();

                //위에 두개가 해당 내용으로 변경됨
                ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);//스프링에서는 얘를씀
        ```

- 스프링한테 환경정보를 던져주고 컨테이너를 활용하여 가져옴

# 스프링 컨테이너와 스프링 빈
## 스프링 컨테이너 생성
- 생성과정
    ```java
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
    ```
    - `ApplicationContext`를 스프링 컨테이너라 한다.
    - `ApplicationContext`는 인터페이스
    - 스프링 컨테이너는 XML을 기반으로 만들 수 있고, 애노테이션 기반의 자바 설정 클래스로 만들 수 있다.
    - `AppConfig`를 사용햇던 방식이 `애노테이션 기반의 자바 설정 클래스`로 `스프링 컨테이너`를 만든것

    `BeanFactory 를 직접 사용하는 경우는 거의 없으므로 일반적으로 ApplicationContext를 스프링 컨테이너 라고함.`

- 스프링 컨테이너 생성
    1. 스프링 컨테이너 생성
    - `new ApplciationConfigApplicationContext(AppConig.class)`
    - 스프링 컨테이너를 생성할 때는 구성정보를 지정해주어야함.
    - 예제는 `AppConfig.class`를 구성정보로 지정

    2. 스프링 빈 등록
    
    - 스프링 빈 저장소 (@Bean 되어있는거)
    
        |빈 이름 | 빈 객체|
        |------|-------|
        | memberService| MemberServiceImpl@x01|
        |orderService|OrderSerivceImpl@x02|
        |memberRepository|MemberMemoryRepository@x03|
        |discountPolicy|RateDiscountPolicy@x04|
    - 스프링 컨테이너는 파라미터로 넘어온 설정 클래스 정보를 사용해서 스프링빈을 등록
    
        *Bean 이름*
        - 빈 이름을 직접 부여할 수도 있다
            `@Bean(name="memberService2")`
        - <b>빈의 이름은 항상 다른 이름을 부여</b>

    3. 스프링 빈 의존관계 설정 - 준비

        |||
        |--|--|
        |memberService|memberRepository|
        |orderService |discountPolicy|

    4. 스프링빈 의존관계 설정 - 완료

        |||
        |--|--|
        |memberService　　　　=>|memberRepository|
        |&nbsp;　　　　　　　　　　➚||
        |orderService 　　　　=>|discountPolicy|
    - 스프링 컨테이너는 설정 정보를 참고해서 의존관계를 주입(DI)
    

